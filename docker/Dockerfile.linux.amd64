FROM alpine:3.20

# Set environment variables
ENV GODEBUG=netdns=go
ENV CI=true

# Install minimal dependencies in a single layer
RUN apk add --no-cache \
    ca-certificates \
    bash \
    curl \
    && curl -fL https://getcli.jfrog.io/v2-jf | sh /dev/stdin 2.73.2 \
    && mv ./jf /usr/local/bin/jf \
    && chmod +x /usr/local/bin/jf

# Add your custom plugin
ADD release/linux/amd64/plugin /bin/

ENTRYPOINT ["/bin/plugin"]
